const fs = require('fs');
const d3 = require('d3');
const jsdom = require('jsdom');
const { JSDOM } = jsdom;

const dom = new JSDOM(`<!DOCTYPE html><body></body>`);

let body = d3.select(dom.window.document.querySelector('body'));
let svg = body.append('svg').attr('width', 1000).attr('height', 1000).attr('xmlns', 'http://www.w3.org/2000/svg');
let ground = svg.append('g').attr('id', 'ground');;

const map = {
  tileSize: 32,
  tiles: [
    [[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [1], [1], [0], [1], [0], [1], [0], [0], [0], [1], [1], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [1], [0], [0], [1], [0], [1], [0], [0], [0], [1], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [1], [0], [0], [1], [0], [1], [0], [0], [0], [1], [1], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [1], [0], [0], [1], [0], [1], [0], [0], [0], [1], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [1], [0], [0], [1], [0], [1], [1], [1], [0], [1], [1], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [0], [0], [0], [1], [0], [1], [1], [1], [0], [1], [1], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [1], [0], [1], [1], [0], [1], [0], [1], [0], [1], [0], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [0], [1], [0], [1], [0], [1], [1], [1], [0], [1], [1], [1], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [0], [0], [0], [1], [0], [1], [0], [1], [0], [1], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [1], [0], [0], [0], [1], [0], [1], [0], [1], [0], [1], [0], [0], [0], [0], [0], [0]],
    [[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]]
  ],
  colors: ['#373', '#fc7']
}

for (let y = 0; y < map.tiles.length; y++) {
  for (let x = 0; x < map.tiles[y].length; x++) {
    const tile = map.tiles[y][x];
    ground.append('rect')
      .attr('x', x * map.tileSize)
      .attr('y', y * map.tileSize)
      .attr('width', map.tileSize)
      .attr('height', map.tileSize)
      .style('fill', map.colors[tile[0]])
      .style('stroke-width', 0.1)
      .style('stroke', 'rgb(0,0,0)');
  }
}

fs.writeFileSync('game.svg', body.html());